import { Selector } from 'webdriverio';
import { getElementByReference } from '../../../../helpers/element-reference-helper';

/**
 * Check if the given elements contains text
 * @param  {String}   selector Element selector
 * @param  {String}   expectedText  The text to check against
 */
export default async (
  selector: string,
  section: ('header' | 'content'),
  checktype: ('contain' | 'be'),
  expectedText: string,
) => {
  let subElementSelector = '';

  /**
     * The expected text
     * @type {String}
     */
  const stringExpectedText = expectedText;
  const elementSelector: Selector = getElementByReference(selector);

  if (section === 'header') {
    subElementSelector = 'ion-card-title';
  } else {
    subElementSelector = 'ion-card-content';
  }

  /**
     * The element from the page
     * @type {Element}
     */
  const elem = await $(elementSelector).$(subElementSelector);

  await elem.waitForDisplayed();

  /**
     * The text of the element
     * @type {String}
     */
  const text = await elem.getText();

  if (checktype === 'contain') {
    expect(text.replace(/\n/, ' ')).toContain(stringExpectedText);
  } else {
    expect(text.replace(/\n/, ' ')).toBe(stringExpectedText);
  }
};
