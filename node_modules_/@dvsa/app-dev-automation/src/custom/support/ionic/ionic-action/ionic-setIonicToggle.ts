import checkIfElementExists from '../../../../boilerplate/support/lib/checkIfElementExists';
import { getElementByReference } from '../../../../helpers/element-reference-helper';

/**
 * Perform an click action on the given element
 * @param  {String}   parent  The parent item that contains the toggle
 * @param  {String}   type    Type of the element (ion-button or button)
 * @param  {String}   text    Text to select by
 */
export default async (
  parent: string,
  text: string,
  status: 'on' | 'off' | 'yes' | 'no',
) => {
  /**
     * The method to call on the browser object
     * @type {String}
     */
  const method = 'click';

  /**
        * Grab the selector for the parent object that was passed in
        * @type {string}
        */
  const parentSelector = getElementByReference(parent);

  /**
        * Construct the element selector for the ion-toggle with the name thats passed in
        */
  const elementSelector = `${parentSelector}//ion-toggle[@name='${text}']`;

  await checkIfElementExists(elementSelector);

  await $(elementSelector).waitForClickable();

  const setTo = (status === 'on' || status === 'yes');
  const isOn = await $(elementSelector).getAttribute('aria-checked') === 'true';

  if (setTo !== isOn) {
    await $(elementSelector)[method]();
  }
};
