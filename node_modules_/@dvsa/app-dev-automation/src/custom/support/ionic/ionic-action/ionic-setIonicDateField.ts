import { Selector } from 'webdriverio';
import { formatISO } from 'date-fns';
import checkIfElementExists from '../../../../boilerplate/support/lib/checkIfElementExists';
import { getElementByReference } from '../../../../helpers/element-reference-helper';

/**
 * Perform an click action on the given element
 * @param  {String}   selector Element selector
 */
export default async (
  day: string,
  month: string,
  year: string,
  selector: string,
) => {
  /**
     * Get the element selection strategy from the lookup
     * @type {Selector}
     */

  const elementSelector: Selector = getElementByReference(selector);

  const d = parseInt(day, 10);
  let m = parseInt(month, 10);
  const y = parseInt(year, 10);

  m -= 1; // Date creator needs a zero based date for month!

  const dateToSet = formatISO(new Date(y, m, d));
  // console.log('>>>> SELECTOR', elementSelector);
  // console.log('>>>> DATE DEBUG', dateToSet);

  await checkIfElementExists(elementSelector);

  await browser.executeScript(`document.querySelector(arguments[0]).value='${dateToSet}'`, [elementSelector]);
};
