"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _asyncbox = require("asyncbox");

var _appiumSupport = require("appium-support");

var _logger = _interopRequireDefault(require("../logger"));

var _lodash = _interopRequireDefault(require("lodash"));

var _bluebird = _interopRequireDefault(require("bluebird"));

var _appiumBaseDriver = require("appium-base-driver");

var _cookies = _interopRequireDefault(require("../cookies"));

const IPHONE_TOP_BAR_HEIGHT = 71;
const IPHONE_SCROLLED_TOP_BAR_HEIGHT = 41;
const IPHONE_X_SCROLLED_OFFSET = 55;
const IPHONE_X_NOTCH_OFFSET_IOS = 24;
const IPHONE_X_NOTCH_OFFSET_IOS_13 = 20;
const IPHONE_LANDSCAPE_TOP_BAR_HEIGHT = 51;
const IPHONE_BOTTOM_BAR_OFFSET = 49;
const TAB_BAR_OFFSET = 33;
const IPHONE_WEB_COORD_SMART_APP_BANNER_OFFSET = 84;
const IPAD_WEB_COORD_SMART_APP_BANNER_OFFSET = 95;
const NOTCHED_DEVICE_SIZES = [{
  w: 1125,
  h: 2436
}, {
  w: 828,
  h: 1792
}, {
  w: 1242,
  h: 2688
}];
const ELEMENT_OFFSET = 5000;
const {
  W3C_WEB_ELEMENT_IDENTIFIER
} = _appiumSupport.util;
const ATOM_WAIT_TIMEOUT = 2 * 60000;
const ATOM_WAIT_ALERT_WAIT = 400;
const commands = {},
      helpers = {},
      extensions = {};

commands.setFrame = async function setFrame(frame) {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  if (_lodash.default.isNull(frame)) {
    this.curWebFrames = [];

    _logger.default.debug('Leaving web frame and going back to default content');

    return;
  }

  if (helpers.hasElementId(frame)) {
    let atomsElement = this.useAtomsElement(helpers.getElementId(frame));
    let value = await this.executeAtom('get_frame_window', [atomsElement]);

    _logger.default.debug(`Entering new web frame: '${value.WINDOW}'`);

    this.curWebFrames.unshift(value.WINDOW);
  } else {
    const atom = _lodash.default.isNumber(frame) ? 'frame_by_index' : 'frame_by_id_or_name';
    let value = await this.executeAtom(atom, [frame]);

    if (_lodash.default.isNull(value) || _lodash.default.isUndefined(value.WINDOW)) {
      throw new _appiumBaseDriver.errors.NoSuchFrameError();
    }

    _logger.default.debug(`Entering new web frame: '${value.WINDOW}'`);

    this.curWebFrames.unshift(value.WINDOW);
  }
};

commands.getCssProperty = async function getCssProperty(propertyName, el) {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  const atomsElement = this.useAtomsElement(el);
  return await this.executeAtom('get_value_of_css_property', [atomsElement, propertyName]);
};

commands.submit = async function submit(el) {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  const atomsElement = this.useAtomsElement(el);
  await this.executeAtom('submit', [atomsElement]);
};

commands.refresh = async function refresh() {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  await this.executeAtom('refresh', []);
};

commands.getUrl = async function getUrl() {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  return await this.remote.execute('window.location.href');
};

commands.title = async function title() {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  return await this.executeAtom('title', [], true);
};

commands.getCookies = async function getCookies() {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  _logger.default.debug('Retrieving all cookies');

  let script = 'return document.cookie';
  let jsCookies = await this.executeAtom('execute_script', [script, []]);
  let cookies = [];

  try {
    for (let [name, value] of _lodash.default.toPairs(_cookies.default.createJWPCookie(undefined, jsCookies))) {
      cookies.push({
        name,
        value
      });
    }

    return cookies;
  } catch (err) {
    _logger.default.error(err);

    throw new _appiumBaseDriver.errors.UnknownError(`Error parsing cookies from result: '${jsCookies}'`);
  }
};

commands.setCookie = async function setCookie(cookie) {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  cookie = _lodash.default.clone(cookie);

  if (!cookie.path) {
    cookie.path = '/';
  }

  const jsCookie = _cookies.default.createJSCookie(cookie.name, cookie.value, {
    expires: _lodash.default.isNumber(cookie.expiry) ? new Date(cookie.expiry * 1000).toUTCString() : cookie.expiry,
    path: cookie.path,
    domain: cookie.domain,
    httpOnly: cookie.httpOnly,
    secure: cookie.secure
  });

  let script = `document.cookie = ${JSON.stringify(jsCookie)}`;
  await this.executeAtom('execute_script', [script, []]);
};

commands.deleteCookie = async function deleteCookie(cookieName) {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  let cookies = await this.getCookies();

  if (_lodash.default.indexOf(_lodash.default.map(cookies, 'name'), cookieName) === -1) {
    _logger.default.debug(`Cookie '${cookieName}' not found. Ignoring.`);

    return true;
  }

  return await this._deleteCookie(cookieName);
};

commands.deleteCookies = async function deleteCookies() {
  if (!this.isWebContext()) {
    throw new _appiumBaseDriver.errors.NotImplementedError();
  }

  let cookies = await this.getCookies();

  if (cookies.length) {
    for (let cookie of cookies) {
      await this._deleteCookie(cookie.name);
    }
  }

  return true;
};

helpers._deleteCookie = async function _deleteCookie(cookieName) {
  _logger.default.debug(`Deleting cookie '${cookieName}'`);

  let webCookie = _cookies.default.expireCookie(cookieName, {
    path: '/'
  });

  let script = `document.cookie = ${JSON.stringify(webCookie)}`;
  await this.executeAtom('execute_script', [script, []]);
};

extensions.findWebElementOrElements = async function findWebElementOrElements(strategy, selector, many, ctx) {
  let atomsElement = this.getAtomsElement(ctx);
  let element;

  let doFind = async () => {
    element = await this.executeAtom(`find_element${many ? 's' : ''}`, [strategy, selector, atomsElement]);
    return !_lodash.default.isNull(element);
  };

  try {
    await this.implicitWaitForCondition(doFind);
  } catch (err) {
    if (err.message && _lodash.default.isFunction(err.message.match) && err.message.match(/Condition unmet/)) {
      element = [];
    } else {
      throw err;
    }
  }

  if (many) {
    return element;
  } else {
    if (!element || _lodash.default.size(element) === 0) {
      throw new _appiumBaseDriver.errors.NoSuchElementError();
    }

    return element;
  }
};

extensions.clickWebCoords = async function clickWebCoords() {
  let coords = await this.translateWebCoords(this.curWebCoords);
  await this.clickCoords(coords);
};

helpers.executeAtom = async function executeAtom(atom, args, alwaysDefaultFrame = false) {
  let frames = alwaysDefaultFrame === true ? [] : this.curWebFrames;
  let promise = this.remote.executeAtom(atom, args, frames);
  return await this.waitForAtom(promise);
};

helpers.executeAtomAsync = async function executeAtomAsync(atom, args, responseUrl) {
  let promise = new _bluebird.default((resolve, reject) => {
    this.asyncPromise = {
      resolve,
      reject
    };
  });
  await this.remote.executeAtomAsync(atom, args, this.curWebFrames, responseUrl);
  return await this.waitForAtom(promise);
};

helpers.getAtomsElement = function getAtomsElement(wdId) {
  let atomsId;

  try {
    atomsId = this.webElementIds[parseInt(wdId, 10) - ELEMENT_OFFSET];
  } catch (e) {
    return null;
  }

  if (_lodash.default.isUndefined(atomsId)) {
    return null;
  }

  return {
    ELEMENT: atomsId
  };
};

helpers.useAtomsElement = function useAtomsElement(el) {
  if (parseInt(el, 10) < ELEMENT_OFFSET) {
    _logger.default.debug(`Element with id '${el}' passed in for use with ` + `atoms, but it's out of our internal scope. Adding ${ELEMENT_OFFSET}.`);

    el = (parseInt(el, 10) + ELEMENT_OFFSET).toString();
  }

  let atomsElement = this.getAtomsElement(el);

  if (atomsElement === null) {
    throw new _appiumBaseDriver.errors.UnknownError(`Error converting element ID for using in WD atoms: '${el}'`);
  }

  return atomsElement;
};

helpers.convertElementsForAtoms = function convertElementsForAtoms(args = []) {
  const resultArgs = [];

  for (const arg of args) {
    if (helpers.hasElementId(arg)) {
      const elementId = helpers.getElementId(arg);
      const atomsElement = this.getAtomsElement(elementId);

      if (atomsElement === null) {
        throw new _appiumBaseDriver.errors.UnknownError(`Error converting element ID for using in WD atoms: '${elementId}'`);
      }

      resultArgs.push(atomsElement);
    } else if (_lodash.default.isArray(arg)) {
      resultArgs.push(this.convertElementsForAtoms(arg));
    } else {
      resultArgs.push(arg);
    }
  }

  return resultArgs;
};

helpers.parseExecuteResponse = function parseExecuteResponse(res) {
  if (_lodash.default.isNull(res) || _lodash.default.isUndefined(res)) return null;
  let wdElement = null;

  if (!_lodash.default.isArray(res)) {
    if (helpers.hasElementId(res)) {
      wdElement = this.parseElementResponse(res);

      if (wdElement === null) {
        throw new _appiumBaseDriver.errors.UnknownError(`Error converting element ID atom for using in WD: '${helpers.getElementId(res)}'`);
      }

      res = wdElement;
    }
  } else {
    let args = [];

    for (let arg of res) {
      wdElement = arg;

      if (helpers.hasElementId(arg)) {
        wdElement = this.parseElementResponse(arg);

        if (wdElement === null) {
          throw new _appiumBaseDriver.errors.UnknownError(`Error converting element ID atom for using in WD: '${helpers.getElementId(arg)}'`);
        }

        args.push(wdElement);
      } else {
        args.push(arg);
      }
    }

    res = args;
  }

  return res;
};

helpers.parseElementResponse = function parseElementResponse(element) {
  let objId = helpers.getElementId(element);
  let clientId = (ELEMENT_OFFSET + this.webElementIds.length).toString();
  this.webElementIds.push(objId);
  return {
    ELEMENT: clientId
  };
};

helpers.getElementId = function getElementId(element) {
  return element.ELEMENT || element[W3C_WEB_ELEMENT_IDENTIFIER];
};

helpers.hasElementId = function hasElementId(element) {
  return _appiumSupport.util.hasValue(element) && (_appiumSupport.util.hasValue(element.ELEMENT) || _appiumSupport.util.hasValue(element[W3C_WEB_ELEMENT_IDENTIFIER]));
};

extensions.getSafariIsIphone = _lodash.default.memoize(async function getSafariIsIphone() {
  try {
    const userAgent = await this.execute('return navigator.userAgent');
    return userAgent.toLowerCase().includes('iphone');
  } catch (err) {
    _logger.default.warn(`Unable to find device type from useragent. Assuming iPhone`);

    _logger.default.debug(`Error: ${err.message}`);
  }

  return true;
});
extensions.getSafariDeviceSize = _lodash.default.memoize(async function getSafariDeviceSize() {
  const script = 'return {height: window.screen.availHeight * window.devicePixelRatio, width: window.screen.availWidth * window.devicePixelRatio};';
  const {
    width,
    height
  } = await this.execute(script);
  const [normHeight, normWidth] = height > width ? [height, width] : [width, height];
  return {
    width: normWidth,
    height: normHeight
  };
});
extensions.getSafariIsNotched = _lodash.default.memoize(async function getSafariIsNotched() {
  try {
    const {
      width,
      height
    } = await this.getSafariDeviceSize();

    for (const device of NOTCHED_DEVICE_SIZES) {
      if (device.w === width && device.h === height) {
        return true;
      }
    }
  } catch (err) {
    _logger.default.warn(`Unable to find device type from dimensions. Assuming the device is not notched`);

    _logger.default.debug(`Error: ${err.message}`);
  }

  return false;
});

extensions.getExtraTranslateWebCoordsOffset = async function getExtraTranslateWebCoordsOffset(wvPos, realDims) {
  let topOffset = 0;
  let bottomOffset = 0;
  const isIphone = await this.getSafariIsIphone();
  const isNotched = isIphone && (await this.getSafariIsNotched());
  const orientation = realDims.h > realDims.w ? 'PORTRAIT' : 'LANDSCAPE';
  const notchOffset = isNotched ? _appiumSupport.util.compareVersions(this.opts.platformVersion, '=', '13.0') ? IPHONE_X_NOTCH_OFFSET_IOS_13 : IPHONE_X_NOTCH_OFFSET_IOS : 0;
  const isScrolled = await this.execute('return document.documentElement.scrollTop > 0');

  if (isScrolled) {
    topOffset = IPHONE_SCROLLED_TOP_BAR_HEIGHT + notchOffset;

    if (isNotched) {
      topOffset -= IPHONE_X_SCROLLED_OFFSET;
    }

    if (orientation === 'LANDSCAPE' && isIphone) {
      topOffset = 0;
    }
  } else {
    topOffset = IPHONE_TOP_BAR_HEIGHT + notchOffset;

    if (isIphone) {
      if (orientation === 'PORTRAIT') {
        bottomOffset = IPHONE_BOTTOM_BAR_OFFSET;
      } else {
        topOffset = IPHONE_LANDSCAPE_TOP_BAR_HEIGHT;
      }
    }

    if (orientation === 'LANDSCAPE' || !isIphone) {
      const tabs = await this.findNativeElementOrElements('-ios predicate string', `name LIKE '*, Tab' AND visible = 1`, true);

      if (tabs.length > 0) {
        topOffset += TAB_BAR_OFFSET;
      }
    }
  }

  topOffset += await this.getExtraNativeWebTapOffset();
  wvPos.y += topOffset;
  realDims.h -= topOffset + bottomOffset;
};

extensions.getExtraNativeWebTapOffset = async function getExtraNativeWebTapOffset() {
  let offset = 0;
  const banners = await this.findNativeElementOrElements('accessibility id', 'Close app download offer', true);

  if (banners.length > 0) {
    offset += (await this.getSafariIsIphone()) ? IPHONE_WEB_COORD_SMART_APP_BANNER_OFFSET : IPAD_WEB_COORD_SMART_APP_BANNER_OFFSET;
  }

  _logger.default.debug(`Additional native web tap offset computed: ${offset}`);

  return offset;
};

async function tapWebElementNatively(driver, atomsElement) {
  try {
    let text = await driver.executeAtom('get_text', [atomsElement]);

    if (!text) {
      text = await driver.executeAtom('get_attribute_value', [atomsElement, 'value']);
    }

    if (text) {
      const els = await driver.findNativeElementOrElements('accessibility id', text, true);

      if (els.length === 1 || els.length === 2) {
        const el = els[0];
        const rect = await driver.proxyCommand(`/element/${_appiumSupport.util.unwrapElement(el)}/rect`, 'GET');

        if (els.length === 2) {
          const el2 = els[1];
          const rect2 = await driver.proxyCommand(`/element/${_appiumSupport.util.unwrapElement(el2)}/rect`, 'GET');

          if (rect.x !== rect2.x || rect.y !== rect2.y || rect.width !== rect2.width || rect.height !== rect2.height) {
            return false;
          }
        }

        const coords = {
          x: Math.round(rect.x + rect.width / 2),
          y: Math.round(rect.y + rect.height / 2)
        };
        await driver.clickCoords(coords);
        return true;
      }
    }
  } catch (err) {
    _logger.default.warn(`Error attempting to click: ${err.message}`);
  }

  return false;
}

extensions.nativeWebTap = async function nativeWebTap(el) {
  const atomsElement = this.useAtomsElement(el);

  if (!(await this.settings.getSettings()).nativeWebTapStrict && (await tapWebElementNatively(this, atomsElement))) {
    return;
  }

  _logger.default.warn('Unable to do simple native web tap. Attempting to convert coordinates');

  await this.executeAtom('get_size', [atomsElement]);
  await this.executeAtom('get_top_left_coordinates', [atomsElement]);
  const {
    width,
    height
  } = await this.executeAtom('get_size', [atomsElement]);
  let {
    x,
    y
  } = await this.executeAtom('get_top_left_coordinates', [atomsElement]);
  x += width / 2;
  y += height / 2;
  this.curWebCoords = {
    x,
    y
  };
  await this.clickWebCoords();
};

extensions.clickCoords = async function clickCoords(coords) {
  await this.performTouch([{
    action: 'tap',
    options: coords
  }]);
};

extensions.translateWebCoords = async function translateWebCoords(coords) {
  _logger.default.debug(`Translating coordinates (${JSON.stringify(coords)}) to web coordinates`);

  let webview = await (0, _asyncbox.retryInterval)(5, 100, async () => {
    const webviews = await this.findNativeElementOrElements('class name', 'XCUIElementTypeWebView', true);

    if (webviews.length === 0) {
      throw new Error(`No webviews found. Unable to translate web coordinates for native web tap`);
    }

    return webviews[0];
  });
  webview = _appiumSupport.util.unwrapElement(webview);
  const rect = await this.proxyCommand(`/element/${webview}/rect`, 'GET');
  const wvPos = {
    x: rect.x,
    y: rect.y
  };
  const realDims = {
    w: rect.width,
    h: rect.height
  };
  const cmd = '(function () { return {w: window.innerWidth, h: window.innerHeight}; })()';
  const wvDims = await this.remote.execute(cmd);
  const implicitWaitMs = this.implicitWaitMs;
  await this.setImplicitWait(0);

  try {
    await this.getExtraTranslateWebCoordsOffset(wvPos, realDims);
  } finally {
    await this.setImplicitWait(implicitWaitMs);
  }

  if (wvDims && realDims && wvPos) {
    let xRatio = realDims.w / wvDims.w;
    let yRatio = realDims.h / wvDims.h;
    let newCoords = {
      x: wvPos.x + Math.round(xRatio * coords.x),
      y: wvPos.y + Math.round(yRatio * coords.y)
    };

    _logger.default.debug(`Converted coordinates: ${JSON.stringify(newCoords)}`);

    _logger.default.debug(`    rect: ${JSON.stringify(rect)}`);

    _logger.default.debug(`    wvPos: ${JSON.stringify(wvPos)}`);

    _logger.default.debug(`    realDims: ${JSON.stringify(realDims)}`);

    _logger.default.debug(`    wvDims: ${JSON.stringify(wvDims)}`);

    _logger.default.debug(`    xRatio: ${JSON.stringify(xRatio)}`);

    _logger.default.debug(`    yRatio: ${JSON.stringify(yRatio)}`);

    _logger.default.debug(`Converted web coords ${JSON.stringify(coords)} ` + `into real coords ${JSON.stringify(newCoords)}`);

    return newCoords;
  }
};

extensions.checkForAlert = async function checkForAlert() {
  return _lodash.default.isString(await this.getAlertText());
};

extensions.waitForAtom = async function waitForAtom(promise) {
  const timer = new _appiumSupport.timing.Timer().start();
  let done = false;
  let error = null;
  promise = _bluebird.default.resolve(promise).timeout(ATOM_WAIT_TIMEOUT).catch(function (err) {
    _logger.default.debug(`Error received while executing atom: ${err.message}`);

    if (err instanceof _bluebird.default.TimeoutError) {
      err = new Error(`Did not get any response for atom execution after ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`);
    }

    error = err;
  }).finally(function () {
    done = true;
  });

  for (let i = 0; i < 10; i++) {
    try {
      await (0, _asyncbox.waitForCondition)(() => done, {
        waitMs: ATOM_WAIT_ALERT_WAIT,
        intervalMs: 0
      });
      break;
    } catch (ign) {}

    try {
      const res = await _bluebird.default.any([this.checkForAlert(), promise]);

      if (error) {
        throw error;
      }

      return this.parseExecuteResponse(res);
    } catch (err) {
      _logger.default.debug(`No alert found: ${err.message}`);
    }
  }

  const res = await promise;

  if (error) {
    throw error;
  }

  return this.parseExecuteResponse(res);
};

extensions.mobileWebNav = async function mobileWebNav(navType) {
  this.remote.allowNavigationWithoutReload = true;

  try {
    await this.executeAtom('execute_script', [`history.${navType}();`, null]);
  } finally {
    this.remote.allowNavigationWithoutReload = false;
  }
};

Object.assign(commands, extensions, helpers);
var _default = commands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy93ZWIuanMiXSwibmFtZXMiOlsiSVBIT05FX1RPUF9CQVJfSEVJR0hUIiwiSVBIT05FX1NDUk9MTEVEX1RPUF9CQVJfSEVJR0hUIiwiSVBIT05FX1hfU0NST0xMRURfT0ZGU0VUIiwiSVBIT05FX1hfTk9UQ0hfT0ZGU0VUX0lPUyIsIklQSE9ORV9YX05PVENIX09GRlNFVF9JT1NfMTMiLCJJUEhPTkVfTEFORFNDQVBFX1RPUF9CQVJfSEVJR0hUIiwiSVBIT05FX0JPVFRPTV9CQVJfT0ZGU0VUIiwiVEFCX0JBUl9PRkZTRVQiLCJJUEhPTkVfV0VCX0NPT1JEX1NNQVJUX0FQUF9CQU5ORVJfT0ZGU0VUIiwiSVBBRF9XRUJfQ09PUkRfU01BUlRfQVBQX0JBTk5FUl9PRkZTRVQiLCJOT1RDSEVEX0RFVklDRV9TSVpFUyIsInciLCJoIiwiRUxFTUVOVF9PRkZTRVQiLCJXM0NfV0VCX0VMRU1FTlRfSURFTlRJRklFUiIsInV0aWwiLCJBVE9NX1dBSVRfVElNRU9VVCIsIkFUT01fV0FJVF9BTEVSVF9XQUlUIiwiY29tbWFuZHMiLCJoZWxwZXJzIiwiZXh0ZW5zaW9ucyIsInNldEZyYW1lIiwiZnJhbWUiLCJpc1dlYkNvbnRleHQiLCJlcnJvcnMiLCJOb3RJbXBsZW1lbnRlZEVycm9yIiwiXyIsImlzTnVsbCIsImN1cldlYkZyYW1lcyIsImxvZyIsImRlYnVnIiwiaGFzRWxlbWVudElkIiwiYXRvbXNFbGVtZW50IiwidXNlQXRvbXNFbGVtZW50IiwiZ2V0RWxlbWVudElkIiwidmFsdWUiLCJleGVjdXRlQXRvbSIsIldJTkRPVyIsInVuc2hpZnQiLCJhdG9tIiwiaXNOdW1iZXIiLCJpc1VuZGVmaW5lZCIsIk5vU3VjaEZyYW1lRXJyb3IiLCJnZXRDc3NQcm9wZXJ0eSIsInByb3BlcnR5TmFtZSIsImVsIiwic3VibWl0IiwicmVmcmVzaCIsImdldFVybCIsInJlbW90ZSIsImV4ZWN1dGUiLCJ0aXRsZSIsImdldENvb2tpZXMiLCJzY3JpcHQiLCJqc0Nvb2tpZXMiLCJjb29raWVzIiwibmFtZSIsInRvUGFpcnMiLCJjb29raWVVdGlscyIsImNyZWF0ZUpXUENvb2tpZSIsInVuZGVmaW5lZCIsInB1c2giLCJlcnIiLCJlcnJvciIsIlVua25vd25FcnJvciIsInNldENvb2tpZSIsImNvb2tpZSIsImNsb25lIiwicGF0aCIsImpzQ29va2llIiwiY3JlYXRlSlNDb29raWUiLCJleHBpcmVzIiwiZXhwaXJ5IiwiRGF0ZSIsInRvVVRDU3RyaW5nIiwiZG9tYWluIiwiaHR0cE9ubHkiLCJzZWN1cmUiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVsZXRlQ29va2llIiwiY29va2llTmFtZSIsImluZGV4T2YiLCJtYXAiLCJfZGVsZXRlQ29va2llIiwiZGVsZXRlQ29va2llcyIsImxlbmd0aCIsIndlYkNvb2tpZSIsImV4cGlyZUNvb2tpZSIsImZpbmRXZWJFbGVtZW50T3JFbGVtZW50cyIsInN0cmF0ZWd5Iiwic2VsZWN0b3IiLCJtYW55IiwiY3R4IiwiZ2V0QXRvbXNFbGVtZW50IiwiZWxlbWVudCIsImRvRmluZCIsImltcGxpY2l0V2FpdEZvckNvbmRpdGlvbiIsIm1lc3NhZ2UiLCJpc0Z1bmN0aW9uIiwibWF0Y2giLCJzaXplIiwiTm9TdWNoRWxlbWVudEVycm9yIiwiY2xpY2tXZWJDb29yZHMiLCJjb29yZHMiLCJ0cmFuc2xhdGVXZWJDb29yZHMiLCJjdXJXZWJDb29yZHMiLCJjbGlja0Nvb3JkcyIsImFyZ3MiLCJhbHdheXNEZWZhdWx0RnJhbWUiLCJmcmFtZXMiLCJwcm9taXNlIiwid2FpdEZvckF0b20iLCJleGVjdXRlQXRvbUFzeW5jIiwicmVzcG9uc2VVcmwiLCJCIiwicmVzb2x2ZSIsInJlamVjdCIsImFzeW5jUHJvbWlzZSIsIndkSWQiLCJhdG9tc0lkIiwid2ViRWxlbWVudElkcyIsInBhcnNlSW50IiwiZSIsIkVMRU1FTlQiLCJ0b1N0cmluZyIsImNvbnZlcnRFbGVtZW50c0ZvckF0b21zIiwicmVzdWx0QXJncyIsImFyZyIsImVsZW1lbnRJZCIsImlzQXJyYXkiLCJwYXJzZUV4ZWN1dGVSZXNwb25zZSIsInJlcyIsIndkRWxlbWVudCIsInBhcnNlRWxlbWVudFJlc3BvbnNlIiwib2JqSWQiLCJjbGllbnRJZCIsImhhc1ZhbHVlIiwiZ2V0U2FmYXJpSXNJcGhvbmUiLCJtZW1vaXplIiwidXNlckFnZW50IiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsIndhcm4iLCJnZXRTYWZhcmlEZXZpY2VTaXplIiwid2lkdGgiLCJoZWlnaHQiLCJub3JtSGVpZ2h0Iiwibm9ybVdpZHRoIiwiZ2V0U2FmYXJpSXNOb3RjaGVkIiwiZGV2aWNlIiwiZ2V0RXh0cmFUcmFuc2xhdGVXZWJDb29yZHNPZmZzZXQiLCJ3dlBvcyIsInJlYWxEaW1zIiwidG9wT2Zmc2V0IiwiYm90dG9tT2Zmc2V0IiwiaXNJcGhvbmUiLCJpc05vdGNoZWQiLCJvcmllbnRhdGlvbiIsIm5vdGNoT2Zmc2V0IiwiY29tcGFyZVZlcnNpb25zIiwib3B0cyIsInBsYXRmb3JtVmVyc2lvbiIsImlzU2Nyb2xsZWQiLCJ0YWJzIiwiZmluZE5hdGl2ZUVsZW1lbnRPckVsZW1lbnRzIiwiZ2V0RXh0cmFOYXRpdmVXZWJUYXBPZmZzZXQiLCJ5Iiwib2Zmc2V0IiwiYmFubmVycyIsInRhcFdlYkVsZW1lbnROYXRpdmVseSIsImRyaXZlciIsInRleHQiLCJlbHMiLCJyZWN0IiwicHJveHlDb21tYW5kIiwidW53cmFwRWxlbWVudCIsImVsMiIsInJlY3QyIiwieCIsIk1hdGgiLCJyb3VuZCIsIm5hdGl2ZVdlYlRhcCIsInNldHRpbmdzIiwiZ2V0U2V0dGluZ3MiLCJuYXRpdmVXZWJUYXBTdHJpY3QiLCJwZXJmb3JtVG91Y2giLCJhY3Rpb24iLCJvcHRpb25zIiwid2VidmlldyIsIndlYnZpZXdzIiwiRXJyb3IiLCJjbWQiLCJ3dkRpbXMiLCJpbXBsaWNpdFdhaXRNcyIsInNldEltcGxpY2l0V2FpdCIsInhSYXRpbyIsInlSYXRpbyIsIm5ld0Nvb3JkcyIsImNoZWNrRm9yQWxlcnQiLCJpc1N0cmluZyIsImdldEFsZXJ0VGV4dCIsInRpbWVyIiwidGltaW5nIiwiVGltZXIiLCJzdGFydCIsImRvbmUiLCJ0aW1lb3V0IiwiY2F0Y2giLCJUaW1lb3V0RXJyb3IiLCJnZXREdXJhdGlvbiIsImFzTWlsbGlTZWNvbmRzIiwidG9GaXhlZCIsImZpbmFsbHkiLCJpIiwid2FpdE1zIiwiaW50ZXJ2YWxNcyIsImlnbiIsImFueSIsIm1vYmlsZVdlYk5hdiIsIm5hdlR5cGUiLCJhbGxvd05hdmlnYXRpb25XaXRob3V0UmVsb2FkIiwiT2JqZWN0IiwiYXNzaWduIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBLE1BQU1BLHFCQUFxQixHQUFHLEVBQTlCO0FBQ0EsTUFBTUMsOEJBQThCLEdBQUcsRUFBdkM7QUFDQSxNQUFNQyx3QkFBd0IsR0FBRyxFQUFqQztBQUNBLE1BQU1DLHlCQUF5QixHQUFHLEVBQWxDO0FBQ0EsTUFBTUMsNEJBQTRCLEdBQUcsRUFBckM7QUFFQSxNQUFNQywrQkFBK0IsR0FBRyxFQUF4QztBQUNBLE1BQU1DLHdCQUF3QixHQUFHLEVBQWpDO0FBQ0EsTUFBTUMsY0FBYyxHQUFHLEVBQXZCO0FBQ0EsTUFBTUMsd0NBQXdDLEdBQUcsRUFBakQ7QUFDQSxNQUFNQyxzQ0FBc0MsR0FBRyxFQUEvQztBQUVBLE1BQU1DLG9CQUFvQixHQUFHLENBQzNCO0FBQUNDLEVBQUFBLENBQUMsRUFBRSxJQUFKO0FBQVVDLEVBQUFBLENBQUMsRUFBRTtBQUFiLENBRDJCLEVBRTNCO0FBQUNELEVBQUFBLENBQUMsRUFBRSxHQUFKO0FBQVNDLEVBQUFBLENBQUMsRUFBRTtBQUFaLENBRjJCLEVBRzNCO0FBQUNELEVBQUFBLENBQUMsRUFBRSxJQUFKO0FBQVVDLEVBQUFBLENBQUMsRUFBRTtBQUFiLENBSDJCLENBQTdCO0FBTUEsTUFBTUMsY0FBYyxHQUFHLElBQXZCO0FBQ0EsTUFBTTtBQUFFQyxFQUFBQTtBQUFGLElBQWlDQyxtQkFBdkM7QUFF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V0FBTCxDQUFpQixnQkFBakIsRUFBbUMsQ0FBRSxXQUFVd0wsT0FBUSxLQUFwQixFQUEwQixJQUExQixDQUFuQyxDQUFOO0FBQ0QsR0FGRCxTQUVVO0FBQ1IsU0FBSzNLLE1BQUwsQ0FBWTRLLDRCQUFaLEdBQTJDLEtBQTNDO0FBQ0Q7QUFDRixDQVBEOztBQVNBQyxNQUFNLENBQUNDLE1BQVAsQ0FBYzdNLFFBQWQsRUFBd0JFLFVBQXhCLEVBQW9DRCxPQUFwQztlQUVlRCxRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmV0cnlJbnRlcnZhbCwgd2FpdEZvckNvbmRpdGlvbiB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCB7IHV0aWwsIHRpbWluZyB9IGZyb20gJ2FwcGl1bS1zdXBwb3J0JztcbmltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgeyBlcnJvcnMgfSBmcm9tICdhcHBpdW0tYmFzZS1kcml2ZXInO1xuaW1wb3J0IGNvb2tpZVV0aWxzIGZyb20gJy4uL2Nvb2tpZXMnO1xuXG5jb25zdCBJUEhPTkVfVE9QX0JBUl9IRUlHSFQgPSA3MTtcbmNvbnN0IElQSE9ORV9TQ1JPTExFRF9UT1BfQkFSX0hFSUdIVCA9IDQxO1xuY29uc3QgSVBIT05FX1hfU0NST0xMRURfT0ZGU0VUID0gNTU7XG5jb25zdCBJUEhPTkVfWF9OT1RDSF9PRkZTRVRfSU9TID0gMjQ7XG5jb25zdCBJUEhPTkVfWF9OT1RDSF9PRkZTRVRfSU9TXzEzID0gMjA7XG5cbmNvbnN0IElQSE9ORV9MQU5EU0NBUEVfVE9QX0JBUl9IRUlHSFQgPSA1MTtcbmNvbnN0IElQSE9ORV9CT1RUT01fQkFSX09GRlNFVCA9IDQ5O1xuY29uc3QgVEFCX0JBUl9PRkZTRVQgPSAzMztcbmNvbnN0IElQSE9ORV9XRUJfQ09PUkRfU01BUlRfQVBQX0JBTk5FUl9PRkZTRVQgPSA4NDtcbmNvbnN0IElQQURfV0VCX0NPT1JEX1NNQVJUX0FQUF9CQU5ORVJfT0ZGU0VUID0gOTU7XG5cbmNvbnN0IE5PVENIRURfREVWSUNFX1NJWkVTID0gW1xuICB7dzogMTEyNSwgaDogMjQzNn0sIC8vIDExIFBybywgWCwgWHNcbiAge3c6IDgyOCwgaDogMTc5Mn0sIC8vIDExLCBYclxuICB7dzogMTI0MiwgaDogMjY4OH0sIC8vIDExIFBybyBNYXgsIFhzIE1heFxuXTtcblxuY29uc3QgRUxFTUVOVF9PRkZTRVQgPSA1MDAwO1xuY29uc3QgeyBXM0NfV0VCX0VMRU1FTlRfSURFTlRJRklFUiB9ID0gdXRpbDtcblxuY29uc3QgQVRPTV9XQUlUX1RJTUVPVVQgPSAyICogNjAwMDA7XG5jb25zdCBBVE9NX1dBSVRfQUxFUlRfV0FJVCA9IDQwMDtcblxuY29uc3QgY29tbWFuZHMgPSB7fSwgaGVscGVycyA9IHt9LCBleHRlbnNpb25zID0ge307XG5cbmNvbW1hbmRzLnNldEZyYW1lID0gYXN5bmMgZnVuY3Rpb24gc2V0RnJhbWUgKGZyYW1lKSB7XG4gIGlmICghdGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICB9XG5cbiAgaWYgKF8uaXNOdWxsKGZyYW1lKSkge1xuICAgIHRoaXMuY3VyV2ViRnJhbWVzID0gW107XG4gICAgbG9nLmRlYnVnKCdMZWF2aW5nIHdlYiBmcmFtZSBhbmQgZ29pbmcgYmFjayB0byBkZWZhdWx0IGNvbnRlbnQnKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoaGVscGVycy5oYXNFbGVtZW50SWQoZnJhbWUpKSB7XG4gICAgbGV0IGF0b21zRWxlbWVudCA9IHRoaXMudXNlQXRvbXNFbGVtZW50KGhlbHBlcnMuZ2V0RWxlbWVudElkKGZyYW1lKSk7XG4gICAgbGV0IHZhbHVlID0gYXdhaXQgdGhpcy5leGVjdXRlQXRvbSgnZ2V0X2ZyYW1lX3dpbmRvdycsIFthdG9tc0VsZW1lbnRdKTtcbiAgICBsb2cuZGVidWcoYEVudGVyaW5nIG5ldyB3ZWIgZnJhbWU6ICcke3ZhbHVlLldJTkRPV30nYCk7XG4gICAgdGhpcy5jdXJXZWJGcmFtZXMudW5zaGlmdCh2YWx1ZS5XSU5ET1cpO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGF0b20gPSBfLmlzTnVtYmVyKGZyYW1lKSA/ICdmcmFtZV9ieV9pbmRleCcgOiAnZnJhbWVfYnlfaWRfb3JfbmFtZSc7XG4gICAgbGV0IHZhbHVlID0gYXdhaXQgdGhpcy5leGVjdXRlQXRvbShhdG9tLCBbZnJhbWVdKTtcbiAgICBpZiAoXy5pc051bGwodmFsdWUpIHx8IF8uaXNVbmRlZmluZWQodmFsdWUuV0lORE9XKSkge1xuICAgICAgdGhyb3cgbmV3IGVycm9ycy5Ob1N1Y2hGcmFtZUVycm9yKCk7XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgRW50ZXJpbmcgbmV3IHdlYiBmcmFtZTogJyR7dmFsdWUuV0lORE9XfSdgKTtcbiAgICB0aGlzLmN1cldlYkZyYW1lcy51bnNoaWZ0KHZhbHVlLldJTkRPVyk7XG4gIH1cbn07XG5cbmNvbW1hbmRzLmdldENzc1Byb3BlcnR5ID0gYXN5bmMgZnVuY3Rpb24gZ2V0Q3NzUHJvcGVydHkgKHByb3BlcnR5TmFtZSwgZWwpIHtcbiAgaWYgKCF0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gIH1cblxuICBjb25zdCBhdG9tc0VsZW1lbnQgPSB0aGlzLnVzZUF0b21zRWxlbWVudChlbCk7XG4gIHJldHVybiBhd2FpdCB0aGlzLmV4ZWN1dGVBdG9tKCdnZXRfdmFsdWVfb2ZfY3NzX3Byb3BlcnR5JywgW2F0b21zRWxlbWVudCwgcHJvcGVydHlOYW1lXSk7XG59O1xuXG5jb21tYW5kcy5zdWJtaXQgPSBhc3luYyBmdW5jdGlvbiBzdWJtaXQgKGVsKSB7XG4gIGlmICghdGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICB9XG5cbiAgY29uc3QgYXRvbXNFbGVtZW50ID0gdGhpcy51c2VBdG9tc0VsZW1lbnQoZWwpO1xuICBhd2FpdCB0aGlzLmV4ZWN1dGVBdG9tKCdzdWJtaXQnLCBbYXRvbXNFbGVtZW50XSk7XG59O1xuXG5jb21tYW5kcy5yZWZyZXNoID0gYXN5bmMgZnVuY3Rpb24gcmVmcmVzaCAoKSB7XG4gIGlmICghdGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICB9XG5cbiAgYXdhaXQgdGhpcy5leGVjdXRlQXRvbSgncmVmcmVzaCcsIFtdKTtcbn07XG5cbmNvbW1hbmRzLmdldFVybCA9IGFzeW5jIGZ1bmN0aW9uIGdldFVybCAoKSB7XG4gIGlmICghdGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICB9XG5cbiAgcmV0dXJuIGF3YWl0IHRoaXMucmVtb3RlLmV4ZWN1dGUoJ3dpbmRvdy5sb2NhdGlvbi5ocmVmJyk7XG59O1xuXG5jb21tYW5kcy50aXRsZSA9IGFzeW5jIGZ1bmN0aW9uIHRpdGxlICgpIHtcbiAgaWYgKCF0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgdGhpcy5leGVjdXRlQXRvbSgndGl0bGUnLCBbXSwgdHJ1ZSk7XG59O1xuXG5jb21tYW5kcy5nZXRDb29raWVzID0gYXN5bmMgZnVuY3Rpb24gZ2V0Q29va2llcyAoKSB7XG4gIGlmICghdGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICB9XG5cbiAgbG9nLmRlYnVnKCdSZXRyaWV2aW5nIGFsbCBjb29raWVzJyk7XG5cbiAgbGV0IHNjcmlwdCA9ICdyZXR1cm4gZG9jdW1lbnQuY29va2llJztcbiAgbGV0IGpzQ29va2llcyA9IGF3YWl0IHRoaXMuZXhlY3V0ZUF0b20oJ2V4ZWN1dGVfc2NyaXB0JywgW3NjcmlwdCwgW11dKTtcblxuICBsZXQgY29va2llcyA9IFtdO1xuICB0cnkge1xuICAgIGZvciAobGV0IFtuYW1lLCB2YWx1ZV0gb2YgXy50b1BhaXJzKGNvb2tpZVV0aWxzLmNyZWF0ZUpXUENvb2tpZSh1bmRlZmluZWQsIGpzQ29va2llcykpKSB7XG4gICAgICBjb29raWVzLnB1c2goe25hbWUsIHZhbHVlfSk7XG4gICAgfVxuICAgIHJldHVybiBjb29raWVzO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cuZXJyb3IoZXJyKTtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLlVua25vd25FcnJvcihgRXJyb3IgcGFyc2luZyBjb29raWVzIGZyb20gcmVzdWx0OiAnJHtqc0Nvb2tpZXN9J2ApO1xuICB9XG59O1xuXG5jb21tYW5kcy5zZXRDb29raWUgPSBhc3luYyBmdW5jdGlvbiBzZXRDb29raWUgKGNvb2tpZSkge1xuICBpZiAoIXRoaXMuaXNXZWJDb250ZXh0KCkpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vdEltcGxlbWVudGVkRXJyb3IoKTtcbiAgfVxuXG4gIGNvb2tpZSA9IF8uY2xvbmUoY29va2llKTtcblxuICAvLyBpZiBgcGF0aGAgZmllbGQgaXMgbm90IHNwZWNpZmllZCwgU2FmYXJpIHdpbGwgbm90IHVwZGF0ZSBjb29raWVzIGFzIGV4cGVjdGVkOyBlZyBpc3N1ZSAjMTcwOFxuICBpZiAoIWNvb2tpZS5wYXRoKSB7XG4gICAgY29va2llLnBhdGggPSAnLyc7XG4gIH1cblxuICBjb25zdCBqc0Nvb2tpZSA9IGNvb2tpZVV0aWxzLmNyZWF0ZUpTQ29va2llKGNvb2tpZS5uYW1lLCBjb29raWUudmFsdWUsIHtcbiAgICBleHBpcmVzOiBfLmlzTnVtYmVyKGNvb2tpZS5leHBpcnkpID8gKG5ldyBEYXRlKGNvb2tpZS5leHBpcnkgKiAxMDAwKSkudG9VVENTdHJpbmcoKSA6XG4gICAgICBjb29raWUuZXhwaXJ5LFxuICAgIHBhdGg6IGNvb2tpZS5wYXRoLFxuICAgIGRvbWFpbjogY29va2llLmRvbWFpbixcbiAgICBodHRwT25seTogY29va2llLmh0dHBPbmx5LFxuICAgIHNlY3VyZTogY29va2llLnNlY3VyZVxuICB9KTtcbiAgbGV0IHNjcmlwdCA9IGBkb2N1bWVudC5jb29raWUgPSAke0pTT04uc3RyaW5naWZ5KGpzQ29va2llKX1gO1xuICBhd2FpdCB0aGlzLmV4ZWN1dGVBdG9tKCdleGVjdXRlX3NjcmlwdCcsIFtzY3JpcHQsIFtdXSk7XG59O1xuXG5jb21tYW5kcy5kZWxldGVDb29raWUgPSBhc3luYyBmdW5jdGlvbiBkZWxldGVDb29raWUgKGNvb2tpZU5hbWUpIHtcbiAgaWYgKCF0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gIH1cblxuICAvLyBjaGVjayBjb29raWUgZXhpc3RlbmNlXG4gIGxldCBjb29raWVzID0gYXdhaXQgdGhpcy5nZXRDb29raWVzKCk7XG4gIGlmIChfLmluZGV4T2YoXy5tYXAoY29va2llcywgJ25hbWUnKSwgY29va2llTmFtZSkgPT09IC0xKSB7XG4gICAgbG9nLmRlYnVnKGBDb29raWUgJyR7Y29va2llTmFtZX0nIG5vdCBmb3VuZC4gSWdub3JpbmcuYCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgdGhpcy5fZGVsZXRlQ29va2llKGNvb2tpZU5hbWUpO1xufTtcblxuY29tbWFuZHMuZGVsZXRlQ29va2llcyA9IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNvb2tpZXMgKCkge1xuICBpZiAoIXRoaXMuaXNXZWJDb250ZXh0KCkpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vdEltcGxlbWVudGVkRXJyb3IoKTtcbiAgfVxuXG4gIGxldCBjb29raWVzID0gYXdhaXQgdGhpcy5nZXRDb29raWVzKCk7XG4gIGlmIChjb29raWVzLmxlbmd0aCkge1xuICAgIGZvciAobGV0IGNvb2tpZSBvZiBjb29raWVzKSB7XG4gICAgICBhd2FpdCB0aGlzLl9kZWxldGVDb29raWUoY29va2llLm5hbWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbmhlbHBlcnMuX2RlbGV0ZUNvb2tpZSA9IGFzeW5jIGZ1bmN0aW9uIF9kZWxldGVDb29raWUgKGNvb2tpZU5hbWUpIHtcbiAgbG9nLmRlYnVnKGBEZWxldGluZyBjb29raWUgJyR7Y29va2llTmFtZX0nYCk7XG4gIGxldCB3ZWJDb29raWUgPSBjb29raWVVdGlscy5leHBpcmVDb29raWUoY29va2llTmFtZSwge3BhdGg6ICcvJ30pO1xuICBsZXQgc2NyaXB0ID0gYGRvY3VtZW50LmNvb2tpZSA9ICR7SlNPTi5zdHJpbmdpZnkod2ViQ29va2llKX1gO1xuICBhd2FpdCB0aGlzLmV4ZWN1dGVBdG9tKCdleGVjdXRlX3NjcmlwdCcsIFtzY3JpcHQsIFtdXSk7XG59O1xuXG5leHRlbnNpb25zLmZpbmRXZWJFbGVtZW50T3JFbGVtZW50cyA9IGFzeW5jIGZ1bmN0aW9uIGZpbmRXZWJFbGVtZW50T3JFbGVtZW50cyAoc3RyYXRlZ3ksIHNlbGVjdG9yLCBtYW55LCBjdHgpIHtcbiAgbGV0IGF0b21zRWxlbWVudCA9IHRoaXMuZ2V0QXRvbXNFbGVtZW50KGN0eCk7XG4gIGxldCBlbGVtZW50O1xuICBsZXQgZG9GaW5kID0gYXN5bmMgKCkgPT4ge1xuICAgIGVsZW1lbnQgPSBhd2FpdCB0aGlzLmV4ZWN1dGVBdG9tKGBmaW5kX2VsZW1lbnQke21hbnkgPyAncycgOiAnJ31gLCBbc3RyYXRlZ3ksIHNlbGVjdG9yLCBhdG9tc0VsZW1lbnRdKTtcbiAgICByZXR1cm4gIV8uaXNOdWxsKGVsZW1lbnQpO1xuICB9O1xuICB0cnkge1xuICAgIGF3YWl0IHRoaXMuaW1wbGljaXRXYWl0Rm9yQ29uZGl0aW9uKGRvRmluZCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChlcnIubWVzc2FnZSAmJiBfLmlzRnVuY3Rpb24oZXJyLm1lc3NhZ2UubWF0Y2gpICYmIGVyci5tZXNzYWdlLm1hdGNoKC9Db25kaXRpb24gdW5tZXQvKSkge1xuICAgICAgLy8gY29uZGl0aW9uIHdhcyBub3QgbWV0IHNldHRpbmcgcmVzIHRvIGVtcHR5IGFycmF5XG4gICAgICBlbGVtZW50ID0gW107XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH1cblxuICBpZiAobWFueSkge1xuICAgIHJldHVybiBlbGVtZW50O1xuICB9IGVsc2Uge1xuICAgIGlmICghZWxlbWVudCB8fCBfLnNpemUoZWxlbWVudCkgPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBlcnJvcnMuTm9TdWNoRWxlbWVudEVycm9yKCk7XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG59O1xuXG5leHRlbnNpb25zLmNsaWNrV2ViQ29vcmRzID0gYXN5bmMgZnVuY3Rpb24gY2xpY2tXZWJDb29yZHMgKCkge1xuICBsZXQgY29vcmRzID0gYXdhaXQgdGhpcy50cmFuc2xhdGVXZWJDb29yZHModGhpcy5jdXJXZWJDb29yZHMpO1xuICBhd2FpdCB0aGlzLmNsaWNrQ29vcmRzKGNvb3Jkcyk7XG59O1xuXG5oZWxwZXJzLmV4ZWN1dGVBdG9tID0gYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUF0b20gKGF0b20sIGFyZ3MsIGFsd2F5c0RlZmF1bHRGcmFtZSA9IGZhbHNlKSB7XG4gIGxldCBmcmFtZXMgPSBhbHdheXNEZWZhdWx0RnJhbWUgPT09IHRydWUgPyBbXSA6IHRoaXMuY3VyV2ViRnJhbWVzO1xuICBsZXQgcHJvbWlzZSA9IHRoaXMucmVtb3RlLmV4ZWN1dGVBdG9tKGF0b20sIGFyZ3MsIGZyYW1lcyk7XG4gIHJldHVybiBhd2FpdCB0aGlzLndhaXRGb3JBdG9tKHByb21pc2UpO1xufTtcblxuaGVscGVycy5leGVjdXRlQXRvbUFzeW5jID0gYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZUF0b21Bc3luYyAoYXRvbSwgYXJncywgcmVzcG9uc2VVcmwpIHtcbiAgLy8gc2F2ZSB0aGUgcmVzb2x2ZSBhbmQgcmVqZWN0IG1ldGhvZHMgb2YgdGhlIHByb21pc2UgdG8gYmUgd2FpdGVkIGZvclxuICBsZXQgcHJvbWlzZSA9IG5ldyBCKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICB0aGlzLmFzeW5jUHJvbWlzZSA9IHtyZXNvbHZlLCByZWplY3R9O1xuICB9KTtcbiAgYXdhaXQgdGhpcy5yZW1vdGUuZXhlY3V0ZUF0b21Bc3luYyhhdG9tLCBhcmdzLCB0aGlzLmN1cldlYkZyYW1lcywgcmVzcG9uc2VVcmwpO1xuICByZXR1cm4gYXdhaXQgdGhpcy53YWl0Rm9yQXRvbShwcm9taXNlKTtcbn07XG5cbmhlbHBlcnMuZ2V0QXRvbXNFbGVtZW50ID0gZnVuY3Rpb24gZ2V0QXRvbXNFbGVtZW50ICh3ZElkKSB7XG4gIGxldCBhdG9tc0lkO1xuICB0cnkge1xuICAgIGF0b21zSWQgPSB0aGlzLndlYkVsZW1lbnRJZHNbcGFyc2VJbnQod2RJZCwgMTApIC0gRUxFTUVOVF9PRkZTRVRdO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgaWYgKF8uaXNVbmRlZmluZWQoYXRvbXNJZCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4ge0VMRU1FTlQ6IGF0b21zSWR9O1xufTtcblxuaGVscGVycy51c2VBdG9tc0VsZW1lbnQgPSBmdW5jdGlvbiB1c2VBdG9tc0VsZW1lbnQgKGVsKSB7XG4gIGlmIChwYXJzZUludChlbCwgMTApIDwgRUxFTUVOVF9PRkZTRVQpIHtcbiAgICBsb2cuZGVidWcoYEVsZW1lbnQgd2l0aCBpZCAnJHtlbH0nIHBhc3NlZCBpbiBmb3IgdXNlIHdpdGggYCArXG4gICAgICBgYXRvbXMsIGJ1dCBpdCdzIG91dCBvZiBvdXIgaW50ZXJuYWwgc2NvcGUuIEFkZGluZyAke0VMRU1FTlRfT0ZGU0VUfS5gKTtcbiAgICBlbCA9IChwYXJzZUludChlbCwgMTApICsgRUxFTUVOVF9PRkZTRVQpLnRvU3RyaW5nKCk7XG4gIH1cbiAgbGV0IGF0b21zRWxlbWVudCA9IHRoaXMuZ2V0QXRvbXNFbGVtZW50KGVsKTtcbiAgaWYgKGF0b21zRWxlbWVudCA9PT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkVycm9yKGBFcnJvciBjb252ZXJ0aW5nIGVsZW1lbnQgSUQgZm9yIHVzaW5nIGluIFdEIGF0b21zOiAnJHtlbH0nYCk7XG4gIH1cbiAgcmV0dXJuIGF0b21zRWxlbWVudDtcbn07XG5cbmhlbHBlcnMuY29udmVydEVsZW1lbnRzRm9yQXRvbXMgPSBmdW5jdGlvbiBjb252ZXJ0RWxlbWVudHNGb3JBdG9tcyAoYXJncyA9IFtdKSB7XG4gIGNvbnN0IHJlc3VsdEFyZ3MgPSBbXTtcbiAgZm9yIChjb25zdCBhcmcgb2YgYXJncykge1xuICAgIGlmIChoZWxwZXJzLmhhc0VsZW1lbnRJZChhcmcpKSB7XG4gICAgICAvLyBHZXQgdGhlIGVsZW1lbnQga2V5IGZyb20gVzNDIG9yIE1KU09OV1Aga2V5XG4gICAgICBjb25zdCBlbGVtZW50SWQgPSBoZWxwZXJzLmdldEVsZW1lbnRJZChhcmcpO1xuICAgICAgY29uc3QgYXRvbXNFbGVtZW50ID0gdGhpcy5nZXRBdG9tc0VsZW1lbnQoZWxlbWVudElkKTtcbiAgICAgIGlmIChhdG9tc0VsZW1lbnQgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IGVycm9ycy5Vbmtub3duRXJyb3IoYEVycm9yIGNvbnZlcnRpbmcgZWxlbWVudCBJRCBmb3IgdXNpbmcgaW4gV0QgYXRvbXM6ICcke2VsZW1lbnRJZH0nYCk7XG4gICAgICB9XG4gICAgICByZXN1bHRBcmdzLnB1c2goYXRvbXNFbGVtZW50KTtcbiAgICB9IGVsc2UgaWYgKF8uaXNBcnJheShhcmcpKSB7XG4gICAgICByZXN1bHRBcmdzLnB1c2godGhpcy5jb252ZXJ0RWxlbWVudHNGb3JBdG9tcyhhcmcpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0QXJncy5wdXNoKGFyZyk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHRBcmdzO1xufTtcblxuaGVscGVycy5wYXJzZUV4ZWN1dGVSZXNwb25zZSA9IGZ1bmN0aW9uIHBhcnNlRXhlY3V0ZVJlc3BvbnNlIChyZXMpIHtcbiAgaWYgKF8uaXNOdWxsKHJlcykgfHwgXy5pc1VuZGVmaW5lZChyZXMpKSByZXR1cm4gbnVsbDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuXG4gIGxldCB3ZEVsZW1lbnQgPSBudWxsO1xuICBpZiAoIV8uaXNBcnJheShyZXMpKSB7XG4gICAgaWYgKGhlbHBlcnMuaGFzRWxlbWVudElkKHJlcykpIHtcbiAgICAgIHdkRWxlbWVudCA9IHRoaXMucGFyc2VFbGVtZW50UmVzcG9uc2UocmVzKTtcbiAgICAgIGlmICh3ZEVsZW1lbnQgPT09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IGVycm9ycy5Vbmtub3duRXJyb3IoYEVycm9yIGNvbnZlcnRpbmcgZWxlbWVudCBJRCBhdG9tIGZvciB1c2luZyBpbiBXRDogJyR7aGVscGVycy5nZXRFbGVtZW50SWQocmVzKX0nYCk7XG4gICAgICB9XG4gICAgICByZXMgPSB3ZEVsZW1lbnQ7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIHZhbHVlIGlzIGFuIGFycmF5LCBzbyBnbyB0aHJvdWdoIGFuZCBjb252ZXJ0IGVhY2hcbiAgICBsZXQgYXJncyA9IFtdO1xuICAgIGZvciAobGV0IGFyZyBvZiByZXMpIHtcbiAgICAgIHdkRWxlbWVudCA9IGFyZztcbiAgICAgIGlmIChoZWxwZXJzLmhhc0VsZW1lbnRJZChhcmcpKSB7XG4gICAgICAgIHdkRWxlbWVudCA9IHRoaXMucGFyc2VFbGVtZW50UmVzcG9uc2UoYXJnKTtcbiAgICAgICAgaWYgKHdkRWxlbWVudCA9PT0gbnVsbCkge1xuICAgICAgICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkVycm9yKGBFcnJvciBjb252ZXJ0aW5nIGVsZW1lbnQgSUQgYXRvbSBmb3IgdXNpbmcgaW4gV0Q6ICcke2hlbHBlcnMuZ2V0RWxlbWVudElkKGFyZyl9J2ApO1xuICAgICAgICB9XG4gICAgICAgIGFyZ3MucHVzaCh3ZEVsZW1lbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXJncy5wdXNoKGFyZyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJlcyA9IGFyZ3M7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn07XG5cbmhlbHBlcnMucGFyc2VFbGVtZW50UmVzcG9uc2UgPSBmdW5jdGlvbiBwYXJzZUVsZW1lbnRSZXNwb25zZSAoZWxlbWVudCkge1xuICBsZXQgb2JqSWQgPSBoZWxwZXJzLmdldEVsZW1lbnRJZChlbGVtZW50KTtcbiAgbGV0IGNsaWVudElkID0gKEVMRU1FTlRfT0ZGU0VUICsgdGhpcy53ZWJFbGVtZW50SWRzLmxlbmd0aCkudG9TdHJpbmcoKTtcbiAgdGhpcy53ZWJFbGVtZW50SWRzLnB1c2gob2JqSWQpO1xuICByZXR1cm4ge0VMRU1FTlQ6IGNsaWVudElkfTtcbn07XG5cbmhlbHBlcnMuZ2V0RWxlbWVudElkID0gZnVuY3Rpb24gZ2V0RWxlbWVudElkIChlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50LkVMRU1FTlQgfHwgZWxlbWVudFtXM0NfV0VCX0VMRU1FTlRfSURFTlRJRklFUl07XG59O1xuXG5oZWxwZXJzLmhhc0VsZW1lbnRJZCA9IGZ1bmN0aW9uIGhhc0VsZW1lbnRJZCAoZWxlbWVudCkge1xuICByZXR1cm4gdXRpbC5oYXNWYWx1ZShlbGVtZW50KSAmJiAodXRpbC5oYXNWYWx1ZShlbGVtZW50LkVMRU1FTlQpIHx8IHV0aWwuaGFzVmFsdWUoZWxlbWVudFtXM0NfV0VCX0VMRU1FTlRfSURFTlRJRklFUl0pKTtcbn07XG5cbmV4dGVuc2lvbnMuZ2V0U2FmYXJpSXNJcGhvbmUgPSBfLm1lbW9pemUoYXN5bmMgZnVuY3Rpb24gZ2V0U2FmYXJpSXNJcGhvbmUgKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHVzZXJBZ2VudCA9IGF3YWl0IHRoaXMuZXhlY3V0ZSgncmV0dXJuIG5hdmlnYXRvci51c2VyQWdlbnQnKTtcbiAgICByZXR1cm4gdXNlckFnZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2lwaG9uZScpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cud2FybihgVW5hYmxlIHRvIGZpbmQgZGV2aWNlIHR5cGUgZnJvbSB1c2VyYWdlbnQuIEFzc3VtaW5nIGlQaG9uZWApO1xuICAgIGxvZy5kZWJ1ZyhgRXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59KTtcblxuZXh0ZW5zaW9ucy5nZXRTYWZhcmlEZXZpY2VTaXplID0gXy5tZW1vaXplKGFzeW5jIGZ1bmN0aW9uIGdldFNhZmFyaURldmljZVNpemUgKCkge1xuICBjb25zdCBzY3JpcHQgPSAncmV0dXJuIHtoZWlnaHQ6IHdpbmRvdy5zY3JlZW4uYXZhaWxIZWlnaHQgKiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgd2lkdGg6IHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfTsnO1xuICBjb25zdCB7d2lkdGgsIGhlaWdodH0gPSBhd2FpdCB0aGlzLmV4ZWN1dGUoc2NyaXB0KTtcbiAgY29uc3QgW25vcm1IZWlnaHQsIG5vcm1XaWR0aF0gPSBoZWlnaHQgPiB3aWR0aCA/IFtoZWlnaHQsIHdpZHRoXSA6IFt3aWR0aCwgaGVpZ2h0XTtcbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogbm9ybVdpZHRoLFxuICAgIGhlaWdodDogbm9ybUhlaWdodCxcbiAgfTtcbn0pO1xuXG5leHRlbnNpb25zLmdldFNhZmFyaUlzTm90Y2hlZCA9IF8ubWVtb2l6ZShhc3luYyBmdW5jdGlvbiBnZXRTYWZhcmlJc05vdGNoZWQgKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHt3aWR0aCwgaGVpZ2h0fSA9IGF3YWl0IHRoaXMuZ2V0U2FmYXJpRGV2aWNlU2l6ZSgpO1xuICAgIGZvciAoY29uc3QgZGV2aWNlIG9mIE5PVENIRURfREVWSUNFX1NJWkVTKSB7XG4gICAgICBpZiAoZGV2aWNlLncgPT09IHdpZHRoICYmIGRldmljZS5oID09PSBoZWlnaHQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cud2FybihgVW5hYmxlIHRvIGZpbmQgZGV2aWNlIHR5cGUgZnJvbSBkaW1lbnNpb25zLiBBc3N1bWluZyB0aGUgZGV2aWNlIGlzIG5vdCBub3RjaGVkYCk7XG4gICAgbG9nLmRlYnVnKGBFcnJvcjogJHtlcnIubWVzc2FnZX1gKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59KTtcblxuZXh0ZW5zaW9ucy5nZXRFeHRyYVRyYW5zbGF0ZVdlYkNvb3Jkc09mZnNldCA9IGFzeW5jIGZ1bmN0aW9uIGdldEV4dHJhVHJhbnNsYXRlV2ViQ29vcmRzT2Zmc2V0ICh3dlBvcywgcmVhbERpbXMpIHtcbiAgbGV0IHRvcE9mZnNldCA9IDA7XG4gIGxldCBib3R0b21PZmZzZXQgPSAwO1xuXG4gIGNvbnN0IGlzSXBob25lID0gYXdhaXQgdGhpcy5nZXRTYWZhcmlJc0lwaG9uZSgpO1xuICBjb25zdCBpc05vdGNoZWQgPSBpc0lwaG9uZSAmJiBhd2FpdCB0aGlzLmdldFNhZmFyaUlzTm90Y2hlZCgpO1xuXG4gIGNvbnN0IG9yaWVudGF0aW9uID0gcmVhbERpbXMuaCA+IHJlYWxEaW1zLncgPyAnUE9SVFJBSVQnIDogJ0xBTkRTQ0FQRSc7XG5cbiAgY29uc3Qgbm90Y2hPZmZzZXQgPSBpc05vdGNoZWRcbiAgICA/IHV0aWwuY29tcGFyZVZlcnNpb25zKHRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24sICc9JywgJzEzLjAnKVxuICAgICAgPyBJUEhPTkVfWF9OT1RDSF9PRkZTRVRfSU9TXzEzXG4gICAgICA6IElQSE9ORV9YX05PVENIX09GRlNFVF9JT1NcbiAgICA6IDA7XG5cbiAgY29uc3QgaXNTY3JvbGxlZCA9IGF3YWl0IHRoaXMuZXhlY3V0ZSgncmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgPiAwJyk7XG4gIGlmIChpc1Njcm9sbGVkKSB7XG4gICAgdG9wT2Zmc2V0ID0gSVBIT05FX1NDUk9MTEVEX1RPUF9CQVJfSEVJR0hUICsgbm90Y2hPZmZzZXQ7XG5cbiAgICBpZiAoaXNOb3RjaGVkKSB7XG4gICAgICB0b3BPZmZzZXQgLT0gSVBIT05FX1hfU0NST0xMRURfT0ZGU0VUO1xuICAgIH1cblxuICAgIC8vIElmIHRoZSBpUGhvbmUgaXMgbGFuZHNjYXBlIHRoZW4gdGhlcmUgaXMgbm8gdG9wIGJhclxuICAgIGlmIChvcmllbnRhdGlvbiA9PT0gJ0xBTkRTQ0FQRScgJiYgaXNJcGhvbmUpIHtcbiAgICAgIHRvcE9mZnNldCA9IDA7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRvcE9mZnNldCA9IElQSE9ORV9UT1BfQkFSX0hFSUdIVCArIG5vdGNoT2Zmc2V0O1xuXG4gICAgaWYgKGlzSXBob25lKSB7XG4gICAgICBpZiAob3JpZW50YXRpb24gPT09ICdQT1JUUkFJVCcpIHtcbiAgICAgICAgLy8gVGhlIGJvdHRvbSBiYXIgaXMgb25seSB2aXNpYmxlIHdoZW4gcG9ydHJhaXRcbiAgICAgICAgYm90dG9tT2Zmc2V0ID0gSVBIT05FX0JPVFRPTV9CQVJfT0ZGU0VUO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG9wT2Zmc2V0ID0gSVBIT05FX0xBTkRTQ0FQRV9UT1BfQkFSX0hFSUdIVDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob3JpZW50YXRpb24gPT09ICdMQU5EU0NBUEUnIHx8ICFpc0lwaG9uZSkge1xuICAgICAgLy8gVGFicyBvbmx5IGFwcGVhciBpZiB0aGUgZGV2aWNlIGlzIGxhbmRzY2FwZSBvciBpZiBpdCdzIGFuIGlQYWQgc28gd2Ugb25seSBjaGVjayB2aXNpYmlsaXR5IGluIHRoaXMgY2FzZVxuICAgICAgY29uc3QgdGFicyA9IGF3YWl0IHRoaXMuZmluZE5hdGl2ZUVsZW1lbnRPckVsZW1lbnRzKCctaW9zIHByZWRpY2F0ZSBzdHJpbmcnLCBgbmFtZSBMSUtFICcqLCBUYWInIEFORCB2aXNpYmxlID0gMWAsIHRydWUpO1xuICAgICAgaWYgKHRhYnMubGVuZ3RoID4gMCkge1xuICAgICAgICB0b3BPZmZzZXQgKz0gVEFCX0JBUl9PRkZTRVQ7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdG9wT2Zmc2V0ICs9IGF3YWl0IHRoaXMuZ2V0RXh0cmFOYXRpdmVXZWJUYXBPZmZzZXQoKTtcblxuICB3dlBvcy55ICs9IHRvcE9mZnNldDtcbiAgcmVhbERpbXMuaCAtPSAodG9wT2Zmc2V0ICsgYm90dG9tT2Zmc2V0KTtcbn07XG5cbmV4dGVuc2lvbnMuZ2V0RXh0cmFOYXRpdmVXZWJUYXBPZmZzZXQgPSBhc3luYyBmdW5jdGlvbiBnZXRFeHRyYU5hdGl2ZVdlYlRhcE9mZnNldCAoKSB7XG4gIGxldCBvZmZzZXQgPSAwO1xuXG4gIC8vIHRyeSB0byBzZWUgaWYgdGhlcmUgaXMgYW4gU21hcnQgQXBwIEJhbm5lclxuICBjb25zdCBiYW5uZXJzID0gYXdhaXQgdGhpcy5maW5kTmF0aXZlRWxlbWVudE9yRWxlbWVudHMoJ2FjY2Vzc2liaWxpdHkgaWQnLCAnQ2xvc2UgYXBwIGRvd25sb2FkIG9mZmVyJywgdHJ1ZSk7XG4gIGlmIChiYW5uZXJzLmxlbmd0aCA+IDApIHtcbiAgICBvZmZzZXQgKz0gYXdhaXQgdGhpcy5nZXRTYWZhcmlJc0lwaG9uZSgpID9cbiAgICAgIElQSE9ORV9XRUJfQ09PUkRfU01BUlRfQVBQX0JBTk5FUl9PRkZTRVQgOlxuICAgICAgSVBBRF9XRUJfQ09PUkRfU01BUlRfQVBQX0JBTk5FUl9PRkZTRVQ7XG4gIH1cblxuICBsb2cuZGVidWcoYEFkZGl0aW9uYWwgbmF0aXZlIHdlYiB0YXAgb2Zmc2V0IGNvbXB1dGVkOiAke29mZnNldH1gKTtcbiAgcmV0dXJuIG9mZnNldDtcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIHRhcFdlYkVsZW1lbnROYXRpdmVseSAoZHJpdmVyLCBhdG9tc0VsZW1lbnQpIHtcbiAgLy8gdHJ5IHRvIGdldCB0aGUgdGV4dCBvZiB0aGUgZWxlbWVudCwgd2hpY2ggd2lsbCBiZSBhY2Nlc3NpYmxlIGluIHRoZVxuICAvLyBuYXRpdmUgY29udGV4dFxuICB0cnkge1xuICAgIGxldCB0ZXh0ID0gYXdhaXQgZHJpdmVyLmV4ZWN1dGVBdG9tKCdnZXRfdGV4dCcsIFthdG9tc0VsZW1lbnRdKTtcbiAgICBpZiAoIXRleHQpIHtcbiAgICAgIHRleHQgPSBhd2FpdCBkcml2ZXIuZXhlY3V0ZUF0b20oJ2dldF9hdHRyaWJ1dGVfdmFsdWUnLCBbYXRvbXNFbGVtZW50LCAndmFsdWUnXSk7XG4gICAgfVxuXG4gICAgaWYgKHRleHQpIHtcbiAgICAgIGNvbnN0IGVscyA9IGF3YWl0IGRyaXZlci5maW5kTmF0aXZlRWxlbWVudE9yRWxlbWVudHMoJ2FjY2Vzc2liaWxpdHkgaWQnLCB0ZXh0LCB0cnVlKTtcbiAgICAgIGlmIChlbHMubGVuZ3RoID09PSAxIHx8IGVscy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgY29uc3QgZWwgPSBlbHNbMF07XG4gICAgICAgIC8vIHVzZSB0YXAgYmVjYXVzZSBvbiBpT1MgMTEuMiBhbmQgYmVsb3cgYG5hdGl2ZUNsaWNrYCBjcmFzaGVzIFdEQVxuICAgICAgICBjb25zdCByZWN0ID0gYXdhaXQgZHJpdmVyLnByb3h5Q29tbWFuZChgL2VsZW1lbnQvJHt1dGlsLnVud3JhcEVsZW1lbnQoZWwpfS9yZWN0YCwgJ0dFVCcpO1xuICAgICAgICBpZiAoZWxzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIGNvbnN0IGVsMiA9IGVsc1sxXTtcbiAgICAgICAgICBjb25zdCByZWN0MiA9IGF3YWl0IGRyaXZlci5wcm94eUNvbW1hbmQoYC9lbGVtZW50LyR7dXRpbC51bndyYXBFbGVtZW50KGVsMil9L3JlY3RgLCAnR0VUJyk7XG5cbiAgICAgICAgICBpZiAoKHJlY3QueCAhPT0gcmVjdDIueCB8fCByZWN0LnkgIT09IHJlY3QyLnkpIHx8XG4gICAgICAgICAgKHJlY3Qud2lkdGggIT09IHJlY3QyLndpZHRoIHx8IHJlY3QuaGVpZ2h0ICE9PSByZWN0Mi5oZWlnaHQpKSB7XG4gICAgICAgICAgICAvLyBUaGVzZSAyIG5hdGl2ZSBlbGVtZW50cyBhcmUgbm90IHJlZmVycmluZyB0byB0aGUgc2FtZSB3ZWIgZWxlbWVudFxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb29yZHMgPSB7XG4gICAgICAgICAgeDogTWF0aC5yb3VuZChyZWN0LnggKyByZWN0LndpZHRoIC8gMiksXG4gICAgICAgICAgeTogTWF0aC5yb3VuZChyZWN0LnkgKyByZWN0LmhlaWdodCAvIDIpLFxuICAgICAgICB9O1xuICAgICAgICBhd2FpdCBkcml2ZXIuY2xpY2tDb29yZHMoY29vcmRzKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICAvLyBhbnkgZmFpbHVyZSBzaG91bGQgZmFsbCB0aHJvdWdoIGFuZCB0cmlnZ2VyIHRoZSBtb3JlIGVsYWJvcmF0ZVxuICAgIC8vIG1ldGhvZCBvZiBjbGlja2luZ1xuICAgIGxvZy53YXJuKGBFcnJvciBhdHRlbXB0aW5nIHRvIGNsaWNrOiAke2Vyci5tZXNzYWdlfWApO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXh0ZW5zaW9ucy5uYXRpdmVXZWJUYXAgPSBhc3luYyBmdW5jdGlvbiBuYXRpdmVXZWJUYXAgKGVsKSB7XG4gIGNvbnN0IGF0b21zRWxlbWVudCA9IHRoaXMudXNlQXRvbXNFbGVtZW50KGVsKTtcblxuICAvLyBpZiBzdHJpY3QgbmF0aXZlIHRhcCwgZG8gbm90IHRyeSB0byBkbyBpdCB3aXRoIFdEQSBkaXJlY3RseVxuICBpZiAoIShhd2FpdCB0aGlzLnNldHRpbmdzLmdldFNldHRpbmdzKCkpLm5hdGl2ZVdlYlRhcFN0cmljdCAmJiBhd2FpdCB0YXBXZWJFbGVtZW50TmF0aXZlbHkodGhpcywgYXRvbXNFbGVtZW50KSkge1xuICAgIHJldHVybjtcbiAgfVxuICBsb2cud2FybignVW5hYmxlIHRvIGRvIHNpbXBsZSBuYXRpdmUgd2ViIHRhcC4gQXR0ZW1wdGluZyB0byBjb252ZXJ0IGNvb3JkaW5hdGVzJyk7XG5cbiAgLy8gYGdldF90b3BfbGVmdF9jb29yZGluYXRlc2AgcmV0dXJucyB0aGUgd3JvbmcgdmFsdWUgc29tZXRpbWVzLFxuICAvLyB1bmxlc3Mgd2UgcHJlLWNhbGwgYm90aCBvZiB0aGVzZSBmdW5jdGlvbnMgYmVmb3JlIHRoZSBhY3R1YWwgY2FsbHNcbiAgYXdhaXQgdGhpcy5leGVjdXRlQXRvbSgnZ2V0X3NpemUnLCBbYXRvbXNFbGVtZW50XSk7XG4gIGF3YWl0IHRoaXMuZXhlY3V0ZUF0b20oJ2dldF90b3BfbGVmdF9jb29yZGluYXRlcycsIFthdG9tc0VsZW1lbnRdKTtcblxuICBjb25zdCB7d2lkdGgsIGhlaWdodH0gPSBhd2FpdCB0aGlzLmV4ZWN1dGVBdG9tKCdnZXRfc2l6ZScsIFthdG9tc0VsZW1lbnRdKTtcbiAgbGV0IHt4LCB5fSA9IGF3YWl0IHRoaXMuZXhlY3V0ZUF0b20oJ2dldF90b3BfbGVmdF9jb29yZGluYXRlcycsIFthdG9tc0VsZW1lbnRdKTtcbiAgeCArPSB3aWR0aCAvIDI7XG4gIHkgKz0gaGVpZ2h0IC8gMjtcblxuICB0aGlzLmN1cldlYkNvb3JkcyA9IHt4LCB5fTtcbiAgYXdhaXQgdGhpcy5jbGlja1dlYkNvb3JkcygpO1xufTtcblxuZXh0ZW5zaW9ucy5jbGlja0Nvb3JkcyA9IGFzeW5jIGZ1bmN0aW9uIGNsaWNrQ29vcmRzIChjb29yZHMpIHtcbiAgYXdhaXQgdGhpcy5wZXJmb3JtVG91Y2goW1xuICAgIHtcbiAgICAgIGFjdGlvbjogJ3RhcCcsXG4gICAgICBvcHRpb25zOiBjb29yZHMsXG4gICAgfSxcbiAgXSk7XG59O1xuXG5leHRlbnNpb25zLnRyYW5zbGF0ZVdlYkNvb3JkcyA9IGFzeW5jIGZ1bmN0aW9uIHRyYW5zbGF0ZVdlYkNvb3JkcyAoY29vcmRzKSB7XG4gIGxvZy5kZWJ1ZyhgVHJhbnNsYXRpbmcgY29vcmRpbmF0ZXMgKCR7SlNPTi5zdHJpbmdpZnkoY29vcmRzKX0pIHRvIHdlYiBjb29yZGluYXRlc2ApO1xuXG4gIC8vIGFic29sdXRpemUgd2ViIGNvb3Jkc1xuICBsZXQgd2VidmlldyA9IGF3YWl0IHJldHJ5SW50ZXJ2YWwoNSwgMTAwLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgd2Vidmlld3MgPSBhd2FpdCB0aGlzLmZpbmROYXRpdmVFbGVtZW50T3JFbGVtZW50cygnY2xhc3MgbmFtZScsICdYQ1VJRWxlbWVudFR5cGVXZWJWaWV3JywgdHJ1ZSk7XG4gICAgaWYgKHdlYnZpZXdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyB3ZWJ2aWV3cyBmb3VuZC4gVW5hYmxlIHRvIHRyYW5zbGF0ZSB3ZWIgY29vcmRpbmF0ZXMgZm9yIG5hdGl2ZSB3ZWIgdGFwYCk7XG4gICAgfVxuICAgIHJldHVybiB3ZWJ2aWV3c1swXTtcbiAgfSk7XG4gIHdlYnZpZXcgPSB1dGlsLnVud3JhcEVsZW1lbnQod2Vidmlldyk7XG5cbiAgY29uc3QgcmVjdCA9IGF3YWl0IHRoaXMucHJveHlDb21tYW5kKGAvZWxlbWVudC8ke3dlYnZpZXd9L3JlY3RgLCAnR0VUJyk7XG4gIGNvbnN0IHd2UG9zID0ge3g6IHJlY3QueCwgeTogcmVjdC55fTtcbiAgY29uc3QgcmVhbERpbXMgPSB7dzogcmVjdC53aWR0aCwgaDogcmVjdC5oZWlnaHR9O1xuXG4gIGNvbnN0IGNtZCA9ICcoZnVuY3Rpb24gKCkgeyByZXR1cm4ge3c6IHdpbmRvdy5pbm5lcldpZHRoLCBoOiB3aW5kb3cuaW5uZXJIZWlnaHR9OyB9KSgpJztcbiAgY29uc3Qgd3ZEaW1zID0gYXdhaXQgdGhpcy5yZW1vdGUuZXhlY3V0ZShjbWQpO1xuXG4gIC8vIGtlZXAgdHJhY2sgb2YgaW1wbGljaXQgd2FpdCwgYW5kIHNldCBsb2NhbGx5IHRvIDBcbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzE0OTg4XG4gIGNvbnN0IGltcGxpY2l0V2FpdE1zID0gdGhpcy5pbXBsaWNpdFdhaXRNcztcbiAgYXdhaXQgdGhpcy5zZXRJbXBsaWNpdFdhaXQoMCk7XG4gIHRyeSB7XG4gICAgYXdhaXQgdGhpcy5nZXRFeHRyYVRyYW5zbGF0ZVdlYkNvb3Jkc09mZnNldCh3dlBvcywgcmVhbERpbXMpO1xuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IHRoaXMuc2V0SW1wbGljaXRXYWl0KGltcGxpY2l0V2FpdE1zKTtcbiAgfVxuXG4gIGlmICh3dkRpbXMgJiYgcmVhbERpbXMgJiYgd3ZQb3MpIHtcbiAgICBsZXQgeFJhdGlvID0gcmVhbERpbXMudyAvIHd2RGltcy53O1xuICAgIGxldCB5UmF0aW8gPSByZWFsRGltcy5oIC8gd3ZEaW1zLmg7XG4gICAgbGV0IG5ld0Nvb3JkcyA9IHtcbiAgICAgIHg6IHd2UG9zLnggKyBNYXRoLnJvdW5kKHhSYXRpbyAqIGNvb3Jkcy54KSxcbiAgICAgIHk6IHd2UG9zLnkgKyBNYXRoLnJvdW5kKHlSYXRpbyAqIGNvb3Jkcy55KSxcbiAgICB9O1xuXG4gICAgLy8gYWRkaXRpb25hbCBsb2dnaW5nIGZvciBjb29yZGluYXRlcywgc2luY2UgaXQgaXMgc29tZXRpbWVzIGJyb2tlblxuICAgIC8vICAgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vYXBwaXVtL2lzc3Vlcy85MTU5XG4gICAgbG9nLmRlYnVnKGBDb252ZXJ0ZWQgY29vcmRpbmF0ZXM6ICR7SlNPTi5zdHJpbmdpZnkobmV3Q29vcmRzKX1gKTtcbiAgICBsb2cuZGVidWcoYCAgICByZWN0OiAke0pTT04uc3RyaW5naWZ5KHJlY3QpfWApO1xuICAgIGxvZy5kZWJ1ZyhgICAgIHd2UG9zOiAke0pTT04uc3RyaW5naWZ5KHd2UG9zKX1gKTtcbiAgICBsb2cuZGVidWcoYCAgICByZWFsRGltczogJHtKU09OLnN0cmluZ2lmeShyZWFsRGltcyl9YCk7XG4gICAgbG9nLmRlYnVnKGAgICAgd3ZEaW1zOiAke0pTT04uc3RyaW5naWZ5KHd2RGltcyl9YCk7XG4gICAgbG9nLmRlYnVnKGAgICAgeFJhdGlvOiAke0pTT04uc3RyaW5naWZ5KHhSYXRpbyl9YCk7XG4gICAgbG9nLmRlYnVnKGAgICAgeVJhdGlvOiAke0pTT04uc3RyaW5naWZ5KHlSYXRpbyl9YCk7XG5cbiAgICBsb2cuZGVidWcoYENvbnZlcnRlZCB3ZWIgY29vcmRzICR7SlNPTi5zdHJpbmdpZnkoY29vcmRzKX0gYCArXG4gICAgICAgICAgICAgIGBpbnRvIHJlYWwgY29vcmRzICR7SlNPTi5zdHJpbmdpZnkobmV3Q29vcmRzKX1gKTtcbiAgICByZXR1cm4gbmV3Q29vcmRzO1xuICB9XG59O1xuXG5leHRlbnNpb25zLmNoZWNrRm9yQWxlcnQgPSBhc3luYyBmdW5jdGlvbiBjaGVja0ZvckFsZXJ0ICgpIHtcbiAgcmV0dXJuIF8uaXNTdHJpbmcoYXdhaXQgdGhpcy5nZXRBbGVydFRleHQoKSk7XG59O1xuXG5leHRlbnNpb25zLndhaXRGb3JBdG9tID0gYXN5bmMgZnVuY3Rpb24gd2FpdEZvckF0b20gKHByb21pc2UpIHtcbiAgY29uc3QgdGltZXIgPSBuZXcgdGltaW5nLlRpbWVyKCkuc3RhcnQoKTtcblxuICAvLyBuZWVkIHRvIGNoZWNrIGZvciBhbGVydCB3aGlsZSB0aGUgYXRvbSBpcyBiZWluZyBleGVjdXRlZC5cbiAgLy8gc28gbm90aWZ5IG91cnNlbHZlcyB3aGVuIGl0IGhhcHBlbnNcbiAgbGV0IGRvbmUgPSBmYWxzZTtcbiAgbGV0IGVycm9yID0gbnVsbDtcbiAgcHJvbWlzZSA9IEIucmVzb2x2ZShwcm9taXNlKSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHByb21pc2UvY2F0Y2gtb3ItcmV0dXJuXG4gICAgLnRpbWVvdXQoQVRPTV9XQUlUX1RJTUVPVVQpXG4gICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBwcm9taXNlL3ByZWZlci1hd2FpdC10by1jYWxsYmFja3NcbiAgICAgIGxvZy5kZWJ1ZyhgRXJyb3IgcmVjZWl2ZWQgd2hpbGUgZXhlY3V0aW5nIGF0b206ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQi5UaW1lb3V0RXJyb3IpIHtcbiAgICAgICAgZXJyID0gbmV3IEVycm9yKGBEaWQgbm90IGdldCBhbnkgcmVzcG9uc2UgZm9yIGF0b20gZXhlY3V0aW9uIGFmdGVyICR7dGltZXIuZ2V0RHVyYXRpb24oKS5hc01pbGxpU2Vjb25kcy50b0ZpeGVkKDApfW1zYCk7XG4gICAgICB9XG4gICAgICAvLyBzYXZlIGFuZCBjaGVjayBsYXRlciwgb3IgYW4gVW5oYW5kbGVkIHJlamVjdGlvbiB3aWxsIGJlIHJlcG9ydGVkXG4gICAgICBlcnJvciA9IGVycjtcbiAgICB9KVxuICAgIC5maW5hbGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgIGRvbmUgPSB0cnVlO1xuICAgIH0pO1xuXG4gIC8vIHRyeSB0ZW4gdGltZXMgdG8gY2hlY2sgYWxlcnRcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgLy8gcGF1c2UsIG9yIHRoZSBhdG9tIHByb21pc2UgaXMgcmVzb2x2ZWRcbiAgICB0cnkge1xuICAgICAgYXdhaXQgd2FpdEZvckNvbmRpdGlvbigoKSA9PiBkb25lLCB7XG4gICAgICAgIHdhaXRNczogQVRPTV9XQUlUX0FMRVJUX1dBSVQsXG4gICAgICAgIGludGVydmFsTXM6IDAsIC8vIGp1c3QgZm9yIHRoZSBwYXVzZSBpbiBleGVjdXRpb25cbiAgICAgIH0pO1xuICAgICAgLy8gYGRvbmVgIGJlY2FtZSB0cnVlLCBzbyBhdG9tIHByb21pc2UgaXMgcmVzb2x2ZWRcbiAgICAgIGJyZWFrO1xuICAgIH0gY2F0Y2ggKGlnbikge1xuICAgICAgLy8gYGRvbmVgIG5ldmVyIGJlY2FtZSB0cnVlLCBzbyBtb3ZlIG9uIHRvIHRyeWluZyB0byBmaW5kIGFuIGFsZXJ0XG4gICAgfVxuXG4gICAgLy8gY2hlY2sgaWYgdGhlcmUgaXMgYW4gYWxlcnQsIG9yIHRoZSBhdG9tIHByb21pc2UgaXMgcmVzb2x2ZWRcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgQi5hbnkoW3RoaXMuY2hlY2tGb3JBbGVydCgpLCBwcm9taXNlXSk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5wYXJzZUV4ZWN1dGVSZXNwb25zZShyZXMpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgLy8gbm8gYWxlcnQgZm91bmQsIHNvIHBhc3MgdGhyb3VnaFxuICAgICAgbG9nLmRlYnVnKGBObyBhbGVydCBmb3VuZDogJHtlcnIubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cblxuICAvLyBhdCB0aGlzIHBvaW50LCBhbGwgdGhhdCBjYW4gYmUgZG9uZSBpcyB3YWl0IGZvciB0aGUgYXRvbSBwcm9taXNlIHRvIGJlXG4gIC8vIHJlc29sdmVkXG4gIGNvbnN0IHJlcyA9IGF3YWl0IHByb21pc2U7XG4gIGlmIChlcnJvcikge1xuICAgIHRocm93IGVycm9yO1xuICB9XG4gIHJldHVybiB0aGlzLnBhcnNlRXhlY3V0ZVJlc3BvbnNlKHJlcyk7XG59O1xuXG5leHRlbnNpb25zLm1vYmlsZVdlYk5hdiA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZVdlYk5hdiAobmF2VHlwZSkge1xuICB0aGlzLnJlbW90ZS5hbGxvd05hdmlnYXRpb25XaXRob3V0UmVsb2FkID0gdHJ1ZTtcbiAgdHJ5IHtcbiAgICBhd2FpdCB0aGlzLmV4ZWN1dGVBdG9tKCdleGVjdXRlX3NjcmlwdCcsIFtgaGlzdG9yeS4ke25hdlR5cGV9KCk7YCwgbnVsbF0pO1xuICB9IGZpbmFsbHkge1xuICAgIHRoaXMucmVtb3RlLmFsbG93TmF2aWdhdGlvbldpdGhvdXRSZWxvYWQgPSBmYWxzZTtcbiAgfVxufTtcblxuT2JqZWN0LmFzc2lnbihjb21tYW5kcywgZXh0ZW5zaW9ucywgaGVscGVycyk7XG5cbmV4cG9ydCBkZWZhdWx0IGNvbW1hbmRzO1xuIl0sImZpbGUiOiJsaWIvY29tbWFuZHMvd2ViLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
